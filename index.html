<!DOCTYPE html>
<html lang="en">
	<head>
    <meta charset="utf-8"/>
    <meta name="Description" content="Stats Collector">
    <meta name="theme-color" content="#FFCF07">
    <meta name="msapplication-TileColor" content="#FFCF07">

    <link rel="manifest" href="manifest.webmanifest">
    <link rel="icon" type="image/x-icon" href="favicon.png">
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="mask-icon" href="safari-pinned-tab.svg" color="#FFCF07">

    <link rel="stylesheet" href="style.css" >
    
    <title>Stats Collector</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	</head>
	<body class="homepage" id="projector">
		<div id="homepage" class="screen">
			<h1>Our Stats</h1>


			<div class="row">
				<div class="columnL">
					<img onclick="toggleActive(this);" src="singleStat.png" class="clicky">
				</div>
				<div class="columnR">
					<div class="activeHide">
						<h4 onclick="toggleActive(this)" class="clicky">Add a single stat</h4>
					</div>
					<div class="activeShow">
						<h4>Choose Stats:</h4>
						<input id="EV" name="EV" type="checkbox" class="dn">
						<label for="EV" class="round">EV</label><br><br>

						<input id="HS" name="HS" type="checkbox" class="dn">
						<label for="HS" class="round">HS</label><br><br>

						<input id="SP" name="SP" type="checkbox" class="dn">
						<label for="SP" class="round">SP</label><br><br>
					</div>
				</div>
			</div>

			<div class="row">
				<div class="columnL">
					<img onclick="toggleActive(this);" src="groupStat.png" class="clicky">
				</div>
				<div class="columnR">
					<div class="activeHide">
						<h4 onclick="toggleActive(this);" class="clicky">Add a group stat</h4>
					</div>
					<div class="activeShow">
						<h4>Choose 1:</h4>
						<input name="EV" type="number" size="3">
						<label for="EV">EV</label><br><br>

						<input name="HS" type="number" size="3">
						<label for="HS">HS</label><br><br>

						<input name="SP" type="number" size="3">
						<label for="SP">SP</label><br><br>
					</div>
				</div>
			</div>

			<select name="movement" id="movement" disabled="true">
			  <option value="" selected disabled hidden>Select Movement</option>
				<option value="buffalo">Buffalo State</option>
				<option value="buffalo">University at Buffalo</option>
				<option value="buffalo">Niagara University</option>
				<option value="buffalo">Daemen College</option>
				<option value="buffalo">SUNY Erie County</option>
			</select>

			<div id="addLocation" class="activeShow">
				<button onclick="addLocationtoList();">Add Location to my list</button>
			</div>
      <div id="submit" class="activeShow">
	      <button onclick="summarize();">Submit</button>
	    </div>

		</div>
		<div id="summary" class="screen">
			<div>
				<h1>Our Stats</h1>

				<br><br><br><br>
				<img src="greatWork.png" width="100%">
				<br><br><br><br>
				<div id="summaryText"><h2>1 HS conversation has been added to your movement!</h2></div><br><br><br>

				<div id="lastScore">
					<button onclick="location = 'https://infobase.cru.org';">Last Score sheet(infobase)</button>
				</div>
				<br><br><br>

				<div id="back">
					<button onclick="location.hash='';">back</button>
				</div>
				<br><br><br>

			</div>
		</div>
		<script>
			function toggleActive(el){
				el.closest('.row').classList.toggle('active'); 
				el.closest('.screen').classList.toggle('active');
        
        let movement = document.getElementById('movement');
				let disabled = movement.disabled;
				if(disabled == true) {
					movement.disabled = false;
				}
				else {
					movement.disabled = true;
				}
			}

			document.addEventListener("DOMContentLoaded", function(){
	      window.addEventListener("hashchange", hashchanged, false);
	      document.getElementById("movement").disabled=true;
	      hashchanged();
	    });

			function hashchanged(){
        var hash = location.hash;

        if(hash == ''){
          document.getElementById('projector').classList = 'homepage';
          window.document.title = "Stats Collectors";
        }
        else if(hash.startsWith('#submit')) {
        	document.getElementById('projector').classList = 'summary';
        	window.document.title = "Stats Summary";
        }
      }     
      function addLocationtoList() {
      	let loca = prompt("What's the location's name?");
      	let movement = document.getElementById('movement');
      	movement.insertAdjacentHTML('beforeend', '<option value="" selected>'+ loca + '</option>');
      }
      function summarize() {
      	let inputs = document.querySelectorAll('.screen.active .row.active input');
      	let stats = [];
      	inputs.forEach(function(input) { 
      		if(input.type == 'number'){
      			if(input.value > 0) {
      				stats.push(input.value + ' ' + input.name);
      			}
      			input.value = '';
      		}
      		else if(input.type == 'checkbox') {
      			if(input.checked) {
      				stats.push('1 ' + input.name);	
      			}
      			input.checked = false;
      		}
				});
				let s = ' has';
				if(stats.length > 1) {
          s = 's have';
				}
				let summary = '<h2>'+stats.join(', ') + ' conversation'+s+' been added to your movement!</h2><br><br><br><h2>3 more days until your team gets a new stats score sheet! Check back then :)</h2>';
				document.getElementById('summaryText').innerHTML = summary;
      	location.hash = 'submit';
      	document.querySelectorAll('.active').forEach(function(active) {
      		active.classList.remove('active');
      	});

	      document.getElementById("movement").disabled = true;
	      document.getElementById("summary").scrollTop = 0;
      }
    
		</script>
	</body>
</html>